<head>
<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<meta name="google-signin-scope" content="profile email">
 <meta name="google-signin-client_id" content="906142115764-3o8h08norcs37j68vr9jd78opnttkioc.apps.googleusercontent.com">
 <script src="https://apis.google.com/js/platform.js" async defer></script>

<html xmlns:th="http://www.thymeleaf.org">

<link rel="stylesheet" href="/css/login.css">
<script>
	$(document).ready(function() {
		$("#facebook").click(function(event){
			event.preventDefault();
			$.ajax(
		            {
		                url: '//connect.facebook.net/en_US/sdk.js',
		                dataType: 'script',
		                cache: true,
		                success:function(script, textStatus, jqXHR)
		                {
		                    FB.init(
		                        {
		                            appId      : '2065417580360306',
		                            xfbml      : true,
		                            version    : 'v2.8'
		                        }
		                    );
		                     
		                    $('#loginbutton,#feedbutton').removeAttr('disabled');
		                    FB.login(function(response){
		                    	 console.log(response);
		                    });
		                   
		                }
		            });
		});
	$("#log").click(function(event){
		event.preventDefault();
		var d = JSON.stringify({email:$("#email").val(),password:$("#password").val()})

		$.post({
			url:"http://localhost:8080/api/login",
			data: d,
			contentType: "application/json",
            success:function(data){
            	if(data == ""){
            		$('#message').html('Wrong username/password').css('color', 'red');
            	}else{
            		$('#message').html('');
            	}
                alert(data)
            }
		});
	});
	
	$("#google").click(function(event){
		event.preventDefault();
		
	        
	        var profile = googleUser.getBasicProfile();
	        var d = JSON.stringify({email:profile.getEmail(),password:""})

			$.post({
				url:"http://localhost:8080/api/login",
				data: d,
				contentType: "application/json",
	            success:function(data){
	            	if(data == ""){
	            		alert("Sing up and verify your email first!");
	            	}
	            }
			});
	
	    
	});
});
	
		
	
</script>
</head>

<div class="container">
  <div class="row">

    <div class="main">

      <h3>Please Log In, or <a href="reg.html">Sign Up</a></h3>
      <div class="row">
        <div class="col-xs-6 col-sm-6 col-md-6">
          <button class="btn btn-lg btn-primary btn-block" id="facebook">Facebook</button>
        </div>
        <div class="col-xs-6 col-sm-6 col-md-6">
          
          <div class="g-signin2" data-theme="dark"><button  class="btn btn-lg btn-info btn-block" id="google">Google</button></div>
		    <script>
		      
		    </script>
        </div>
      </div>
      <div class="login-or">
        <hr class="hr-or">
        <span class="span-or">or</span>
      </div>

      <form role="form" method = "POST">
        <div class="form-group">
          <label for="email">Email</label>
          <input type="text" class="form-control" id="email" required>
        </div>
        <div class="form-group">
          <!--<a class="pull-right" href="#">Forgot password?</a>!-->
          <label for="password">Password</label>
          <input type="password" class="form-control" id="password" required>
          <p id="message"></p>
        </div>
        <button type="submit" class="btn btn btn-primary" id="log">
          Log In
        </button>
        <a href="https://www.google.com/accounts/Logout?continue=https://appengine.google.com/_ah/logout?continue=http://localhost:8080/singin.html">Sign out</a>
		
      </form>
    
    </div>
    
  </div>
</div>
</html>