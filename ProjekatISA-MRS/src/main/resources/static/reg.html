<head><script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<html xmlns:th="http://www.thymeleaf.org">
<meta name="google-signin-scope" content="profile email">
<meta name="google-signin-client_id" content="906142115764-3o8h08norcs37j68vr9jd78opnttkioc.apps.googleusercontent.com">
<script src="https://apis.google.com/js/platform.js" async defer></script>
<link rel="stylesheet" href="/css/login.css">
<script>

$(document).ready(function() {
	$("#register").click(function(event){
		if ($('#password').val() != $('#r-password').val()){
			return;
		} 
		event.preventDefault();
		var d = JSON.stringify({email:$("#email").val(),password:$("#password").val(),name:$("#name").val(),surname:$("#surname").val(),picture:document.getElementById('profile-img').src})
		
		$.post({
			url:"http://localhost:8080/api/register",
			data: d,
			contentType: "application/json",
            success:function(data){
            	
            	if(data == ""){
            		$('#message-email').html('Email already exists').css('color', 'red');
            	}else{
            		$('#message-email').html('');
            	}
            }
		});
	});
	function readURL(input){
		var reader = new FileReader();

        reader.onload = function (e) {
            document.getElementById('profile-img').src =  reader.result;

        }

        reader.readAsDataURL(input.files[0]);
	};
	$("#file").change(function(){
        readURL(this);
    });

    $('#password, #r-password').on('keyup', function () {
    	  if ($('#password').val() == $('#r-password').val()) {
    	    $('#message').html('Passwords matching').css('color', 'green');
    	  } else 
    	    $('#message').html('Passwords does not match').css('color', 'red');
    	});
});
</script>
</head>
<div class="container">
  <div class="row">

    <div class="main">
	<img class="profile-img" id = "profile-img" src="https://lh5.googleusercontent.com/-b0-k99FZlyE/AAAAAAAAAAI/AAAAAAAAAAA/eu7opA4byxI/photo.jpg?sz=120"
                    alt="">
      <h3>Sing Up</h3>
      <div class="row">
        <div class="col-xs-6 col-sm-6 col-md-6">
          <a href="#" class="btn btn-lg btn-primary btn-block">Facebook</a>
        </div>
        <div class="col-xs-6 col-sm-6 col-md-6">
           <div class="g-signin2" data-onsuccess="onSignIn" data-theme="dark"><button class="btn btn-lg btn-info btn-block" id="google">Google</button></div>
		    <script>
		      function onSignIn(googleUser) {
		        // Useful data for your client-side scripts:
		        var profile = googleUser.getBasicProfile();
		        
		        var d = JSON.stringify({email: profile.getEmail(),password:"",name:profile.getGivenName(),surname:profile.getFamilyName(),picture:profile.getImageUrl()})
		        $.post({
					url:"http://localhost:8080/api/register",
					data: d,
					contentType: "application/json",
		            success:function(data){
		            	
		            	if(data == ""){
		            		alert("Email already exist!")
		            	}
		            }
				});
		      };
		    </script>
        </div>
   
      </div>
      <div class="login-or">
        <hr class="hr-or">
        <span class="span-or">or</span>
      </div>

      <form role="form" method = "POST">
        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" class="form-control" id="email" required>
          <p id="message-email"></p>
        </div>
        <div class="form-group">
          <!--<a class="pull-right" href="#">Forgot password?</a>!-->
          <label for="password">Password</label>
          <input type="password" class="form-control" id="password" required>
        </div>
        <div class="form-group">
          <!--<a class="pull-right" href="#">Forgot password?</a>!-->
          <label for="r-password">Repeat password</label>
          <input type="password" class="form-control" id="r-password" required>
          <p id="message"></p>
        </div>
        <div class="form-group">
          <label for="name">Name</label>
          <input type="text" class="form-control" id="name" required>
        </div>
        <div class="form-group">
          <label for="Surname">Surname</label>
          <input type="text" class="form-control" id="surname" required>
        </div>
        <div class="form-group">
          	<label for="profile-picture">Profile picture</label>
    		<input type="file" class="form-control-file" id="file">
        </div>
        <button type="submit" class="btn btn btn-primary" id="register">
          Log In
        </button>
      </form>
    
    </div>
    
  </div>
</div>
</html>