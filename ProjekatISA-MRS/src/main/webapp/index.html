<html>

<head>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<link href="resources/css/popup_windows.css" rel="stylesheet" />
<link href="resources/css/styles.css" rel="stylesheet" />
<script type="text/javascript" src="resources/js/popup_control.js"></script>
<script type="text/javascript" src="resources/js/adminct.js"></script>
<link rel="stylesheet" href="resources/css/startpage.css">

<title>Tim12 Cogi</title>

</head>
<script type="text/javascript">

function renderCinemaTheaters(data) {
	// JAX-RS serializes an empty list as null, and a 'collection of one' as an object (not an 'array of one')
	var list = data == null ? [] : (data instanceof Array ? data : [ data ]);
	cinemas = list;
	$.each(list, function(index, cinema) {
		if(cinema.isCinema == true){
			$('#cinemas').append("<a class=\"cinthe_list\" href=\"javascript:showDetails();\">"+cinema.name+"</a>");
		}else{
			$('#theatres').append("<a class=\"cinthe_list\" href=\"javascript:showDetails();\">"+cinema.name+"</a>");
		}
        
	});
	
}


function getCinemas() {
    console.log( "ready!" );
    $.ajax({
    	type : 'GET',
		url : 'http://localhost:8080/load_cinemas',
		dataType : "json", // data type of response
		success : renderCinemaTheaters,
	});
}

function showCinemaList(){
	$('#cinemas')[0].style.display = "block";
}

function showTheatreList(){
	$('#theatres')[0].style.display = "block";
}

function closeList(event){
	var cinthe_list = $('.cinthe_list');
	var cinthe_details = $('.cinthe_details');
	if ($.inArray(event.target, cinthe_list) == -1) {
		$('#cinemas')[0].style.display = "none";
    	$('#theatres')[0].style.display = "none";
    }
	if ($.inArray(event.target, cinthe_details) == -1) {
		$('.cinthe_details')[0].style.display = "none";
	}
}

function showDetails(){
	$('.cinthe_details').empty();
	$('.cinthe_details').append("<p>Cinema/Theatre</p>");
	$('.cinthe_details')[0].style.display = "block";
}


getCinemas();
</script>
<body onclick="closeList(event);">
	<div class="main_page">
		<button type="button" onclick="displayCinemaAdd()">Add new Cinema/Theater</button>
		<button type="button" onclick="displayAdminAdd()">Add admin</button>


		<div id="popup_cinema_add">
			<table>
				<tr>
					<td>Name:</td>
					<td><input type="text" name="place" id="cinema_name" /></td>
				</tr>
				<tr>
					<td>Address:</td>
					<td><input type="text" name="region" id="cinema_address" /></td>
				</tr>
				<tr>
					<td>Description:</td>
					<td><input type="text" name="description" id="cinema_description" />
					</td>
				</tr>
				<tr>
					<td><input type="checkbox" name="is_cinema" id="cinema_is_cinema">Is
						cinema</td>
				</tr>
				<tr>
					<td><button type = "button" id="add_hall" onclick="displayHallAdd()">Add hall</button></td>
				</tr>
				<tr>
					<td> <ul id = "cinema_halls"> </ul></td>
				</tr>
				<tr>
					<td>
						<button type="button" id="create_cinema" onclick="checkCinemaAdd()">Add</button>
					</td>
					<td><button type="button" onclick="closePopups()">Cancel</button></td>
				</tr>
			</table>
		</div>
		
		<div id = "popup_add_hall">
			<table>
				<tr>
					<td>Number of rows:</td>
					<td><input type="text" name="hall_row" id="hall_row_num" /></td>
				</tr>
				<tr>
					<td>Number of columns:</td>
					<td><input type="text" name="hall_column" id="hall_column_num" /></td>
				</tr>
				<tr>
					<td>
						<button type="button" onclick="cinemaHallAdd()">Add</button>
					</td>
					<td><button type="button" onclick="displayCinemaAdd()">Cancel</button></td>
				</tr>
			</table>
		</div>
		
		<div id="popup_admin_add">
			<table>
				<tr>
					<td>Username:</td>
					<td><input type="text" name="username" id="admin_username" /></td>
				</tr>
				<tr>
					<td>Password:</td>
					<td><input type="password" name="passowrd" id="admin_password" /></td>
				</tr>
				<tr>
					<td>
						<form action="" id= "admin_type_input">
						  <input type="radio" name="admin_type" value="system">System<br>
						  <input type="radio" name="admin_type" value="cinema_theater">Cinema/Theater<br>
						  <input type="radio" name="admin_type" value="fan_zone"> Fan Zone
						</form>
					</td>
				</tr>
				<tr>
					<td>
						<button type="button" id="create_cinema" onclick="">Add</button>
					</td>
					<td><button type="button" onclick="closePopups()">Cancel</button></td>
				</tr>
			</table>
		</div>

	</div>
	
	<div class="header">
		<a href="" class="logo">Movies and Shows</a>
		<div class="header-right">
    		<a href="reg.html">Registracija</a>
    		<a href="signin.html">Log in</a>
  		</div>
		
	</div>
	
	<div id="cinthe">
		<a class="cinthe" href="javascript:showCinemaList();">
			<div class="cinthe">
				<img class="cinthe" src="resources/images/cinema.jpg">
		    	<p>CINEMAS</p>
			</div>
		</a>
		<a class="cinthe" href="javascript:showTheatreList();">
			<div class="cinthe">
				<img class="cinthe" src="resources/images/theatre.jpg">
		    	<p>THEATRES</p>
			</div>
		</a>
	</div>
	
	<div class="cinthe_list" id="cinemas">
		
	</div>
	
	<div class="cinthe_list" id="theatres">
		
	</div>
	
	<div class="cinthe_details">
	
	</div>
</body>

</html>